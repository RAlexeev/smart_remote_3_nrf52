<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Smart Remote 3 nRF52 v1.2 : Running a DFU</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Smart Remote 3 nRF52 v1.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s130","s132","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dfu_performing.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Running a DFU </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The update procedure presented in this section uses the precompiled firmware packages delivered with Smart Remote. However, the DFU process looks exactly the same if you were to use your own firmware packages.</p>
<h1><a class="anchor" id="dfu_performing_intro"></a>
Introduction</h1>
<p>Smart Remote comes with precompiled firmware packages which you can use to test the DFU process. You can find them in the <code>Precompiled Firmware</code> folder:</p>
<ul>
<li><code>PCA20023-SR3_nRF52832_Product_Example_DFU_Package</code> - Precompiled firmware package for the product example based on nRF52832.</li>
<li><code>PCA63519-SR3_nRF52832_Shield_DFU_Package</code> - Precompiled firmware package for the Smart Remote DK add-on.</li>
<li><code>PCA20031-SR3_nRF52810_Product_Example_DFU_Package</code> - Precompiled firmware package for the product example based on nRF52810.</li>
</ul>
<p>These packages are fully functional and do not require you to generate new keys, bootloader, or bootloader settings, as long as you use the provided precompiled firmware. If you want to run a DFU on your own application, you need to create your own DFU ZIP package, keys, and bootloader. See <a class="el" href="dfu_generating.html">Generating custom firmware packages for DFU</a>.</p>
<p>There are two ways to run a DFU: using a desktop or a mobile device. The procedure is the same for the product example and for the DK add-on.</p>
<h1><a class="anchor" id="dfu_performing_desktop"></a>
Performing the upgrade with nRF Connect (desktop)</h1>
<p>Install the following software on your desktop computer before running this procedure:</p>
<ul>
<li><a href="https://www.nordicsemi.com/eng/Products/Bluetooth-low-energy/nRF-Connect-for-desktop" target="blank">nRF Connect for desktop</a></li>
</ul>
<p>You will also need either an nRF51 or an nRF52 DK board that will function as a connectivity board during DFU.</p>
<ol type="1">
<li>Power on the device that is being updated. Make sure your Smart Remote is programmed with an appropriate firmware HEX file. See <a class="el" href="firmware_config.html">Step-by-step firmware configuration</a>.</li>
<li>Connect another DK to your computer through the USB port. This DK will serve as an intermediate connectivity board. You can use either an nRF51 or an nRF52 DK for this purpose. It is recommended to erase this board prior to using it for DFU.</li>
<li>Run nRF Connect. From the list of ports, choose the serial port on which the connectivity board is connected.<br/>
 <div class="image">
<img src="NRFConnect_Desktop01_SelectCOM.png" alt="NRFConnect_Desktop01_SelectCOM.png"/>
</div>
 <br/>
</li>
<li>If the board was erased before, a message appears saying that no connectivity firmware was detected. Agree to automatically update the connectivity firmware.<br/>
 <div class="image">
<img src="NRFConnect_Desktop00_ConnectivityFW.png" alt="NRFConnect_Desktop00_ConnectivityFW.png"/>
</div>
 <br/>
</li>
<li>Click <b>Start Scan</b>. From the available discovered devices, connect to <code>Smart Remote 3</code>. Make sure it is not bonded to another host.<br/>
 <div class="image">
<img src="NRFConnect_Desktop02_Scan.png" alt="NRFConnect_Desktop02_Scan.png"/>
</div>
 <br/>
 <dl class="section note"><dt>Note</dt><dd>The list of discovered devices is not automatically refreshed when they stop advertising. Whenever you have problems connecting to a device from the list, try clearing the list and rerunning the scan. If Smart Remote stops advertising, tap or move the device to wake it up from low power mode. <br/>
</dd></dl>
</li>
<li>Open pairing settings for the newly connected device. <br/>
 <div class="image">
<img src="NRFConnect_Desktop03_Connected.png" alt="NRFConnect_Desktop03_Connected.png"/>
</div>
 <br/>
</li>
<li>When pairing, make sure to check the <b>Perform bonding</b> option. <br/>
 <div class="image">
<img src="NRFConnect_Desktop04_Bond.png" alt="NRFConnect_Desktop04_Bond.png"/>
</div>
 <br/>
</li>
<li>When the device is bonded, close the window. <br/>
 <div class="image">
<img src="NRFConnect_Desktop05_Bonded.png" alt="NRFConnect_Desktop05_Bonded.png"/>
</div>
 <br/>
</li>
<li>Click the DFU icon in nRF Connect. <br/>
 <div class="image">
<img src="NRFConnect_Desktop06_DFUInit.png" alt="NRFConnect_Desktop06_DFUInit.png"/>
</div>
 <br/>
</li>
<li>Select the package to be transmitted to your device. <br/>
 <div class="image">
<img src="NRFConnect_Desktop07_DFUChooseFile.png" alt="NRFConnect_Desktop07_DFUChooseFile.png"/>
</div>
 <br/>
</li>
<li>After selecting the package, click <b>Start DFU</b>. <br/>
 <div class="image">
<img src="NRFConnect_Desktop08_DFUStart.png" alt="NRFConnect_Desktop08_DFUStart.png"/>
</div>
 <br/>
</li>
<li>Smart Remote device reboots to the bootloader and enters DFU mode. nRF Connect disconnects and automatically reconnects to the device using the same bonding information.</li>
<li>The DFU package is now uploaded to Smart Remote.<br/>
 <dl class="section note"><dt>Note</dt><dd>For packages containing a complete firmware (a package with the SoftDevice, bootloader, and application), this is a two-stage process, in which the SoftDevice and the bootloader are updated first, followed by the application. <br/>
</dd></dl>
</li>
<li>Progress can be observed on the graph. <br/>
 <div class="image">
<img src="NRFConnect_Desktop09_DFUTransfer.png" alt="NRFConnect_Desktop09_DFUTransfer.png"/>
</div>
 <br/>
</li>
<li>Wait until the DFU process is completed. <br/>
 <div class="image">
<img src="NRFConnect_Desktop10_DFUTransferDone.png" alt="NRFConnect_Desktop10_DFUTransferDone.png"/>
</div>
 <br/>
</li>
<li>When the package upload is completed, the device reboots. In a two-stage process, the device re-enters the bootloader to continue upload of the second part of the DFU package. <br/>
 <div class="image">
<img src="NRFConnect_Desktop11_DFUSecondStage.png" alt="NRFConnect_Desktop11_DFUSecondStage.png"/>
</div>
 <br/>
</li>
<li>After the DFU process is finished, the device reboots back to the application. <br/>
 <div class="image">
<img src="NRFConnect_Desktop12_DFUCompleted.png" alt="NRFConnect_Desktop12_DFUCompleted.png"/>
</div>
 <br/>
 </li>
</ol>
<h1><a class="anchor" id="dfu_performing_mobile"></a>
Performing the upgrade (mobile)</h1>
<p>Install the following software on your mobile device before running this procedure:</p>
<ul>
<li><a href="https://www.nordicsemi.com/eng/Products/Nordic-mobile-Apps/nRF-Connect-for-mobile-previously-called-nRF-Master-Control-Panel" target="blank">nRF Connect for Mobile</a></li>
</ul>
<ol type="1">
<li>Transfer the ZIP packages that will be used for DFU to your mobile device.</li>
<li>Power on the product example or the DK add-on. Make sure your Smart Remote is programmed with an appropriate HEX file. See <a class="el" href="firmware_config.html">Step-by-step firmware configuration</a>.</li>
<li>Open nRF Connect on your mobile device.</li>
<li>Tap Scan and find <code>Smart Remote 3</code> on the discovered devices list.</li>
<li>Connect to the Smart Remote device. <br/>
 <div class="image">
<img src="NRFConnect_Android01_Connect.png" alt="NRFConnect_Android01_Connect.png"/>
</div>
 <br/>
</li>
<li>Open the settings and bond with the device. <br/>
 <div class="image">
<img src="NRFConnect_Android02_Bond.png" alt="NRFConnect_Android02_Bond.png"/>
</div>
 <br/>
</li>
<li>Tap <b>Bond</b> to bond with the device. <br/>
 <div class="image">
<img src="NRFConnect_Android03_BondClick.png" alt="NRFConnect_Android03_BondClick.png"/>
</div>
 <br/>
 <dl class="section note"><dt>Note</dt><dd>The list of discovered devices is not automatically refreshed when they stop advertising. Whenever you have problems connecting to a device from the list, try refreshing the list. If Smart Remote stops advertising, tap or move the device. <br/>
</dd></dl>
</li>
<li>To start the DFU process, tap the DFU icon. <br/>
 <div class="image">
<img src="NRFConnect_Android04_DfuInit.png" alt="NRFConnect_Android04_DfuInit.png"/>
</div>
 <br/>
</li>
<li>Select <b>Distribution packet (ZIP)</b> and navigate to the ZIP package that you have previously uploaded to your mobile device. <br/>
 <div class="image">
<img src="NRFConnect_Android05_DfuChooseFile.png" alt="NRFConnect_Android05_DfuChooseFile.png"/>
</div>
 <br/>
</li>
<li>Smart Remote reboots to the bootloader. <br/>
 <div class="image">
<img src="NRFConnect_Android06_DfuEnterBootloader.png" alt="NRFConnect_Android06_DfuEnterBootloader.png"/>
</div>
 <br/>
</li>
<li>The host reconnects to the device using the same bonding information. <br/>
 <div class="image">
<img src="NRFConnect_Android07_DfuStart1.png" alt="NRFConnect_Android07_DfuStart1.png"/>
</div>
 <br/>
</li>
<li>The DFU package is now uploaded to Smart Remote. <br/>
 <dl class="section note"><dt>Note</dt><dd>For packages containing a complete firmware (a package with SoftDevice, bootloader, and application), this is a two-stage process in which the SoftDevice and the bootloader are updated first, followed by the application. The Android version of nRF Connect performs DFU process in the background service. For information on the current stage and progress of the DFU, check the Android status bar. <br/>
</dd></dl>
</li>
<li>Progress can be observed on the graph. <br/>
 <div class="image">
<img src="NRFConnect_Android08_DfuProgress1.png" alt="NRFConnect_Android08_DfuProgress1.png"/>
</div>
 <br/>
</li>
<li>Alternatively, progress can be observed on the Android status bar. <br/>
 <div class="image">
<img src="NRFConnect_Android09_DfuProgress1b.png" alt="NRFConnect_Android09_DfuProgress1b.png"/>
</div>
 <br/>
</li>
<li>When package upload is completed, the device reboots. In a two-stage process, the device re-enters the bootloader to continue upload of the second part of the DFU package. <br/>
 <div class="image">
<img src="NRFConnect_Android10_DfuDisconnecting.png" alt="NRFConnect_Android10_DfuDisconnecting.png"/>
</div>
 <br/>
</li>
<li>Progress can be observed as before. Note that information about the package part being currently uploaded is provided. <br/>
 <div class="image">
<img src="NRFConnect_Android12_DfuProgress2.png" alt="NRFConnect_Android12_DfuProgress2.png"/>
</div>
 <br/>
</li>
<li>After the DFU process is finished, the device reboots back to the application. Refresh the services if needed. <br/>
 <div class="image">
<img src="NRFConnect_Android14_RefreshServices.png" alt="NRFConnect_Android14_RefreshServices.png"/>
</div>
 <br/>
 </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Jun 7 2018" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
