<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Smart Remote 3 nRF52 v1.2 : Bluetooth Console</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Smart Remote 3 nRF52 v1.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s130","s132","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ble_console.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Bluetooth Console </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>With <em>Bluetooth</em> Console, it is possible to remotely debug a device over <em>Bluetooth</em> Low Energy. It uses the <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/group__ble__nus.html" target="_blank">Nordic UART Service (NUS)</a> to communicate with the logger module running on the Smart Remote device. The logger module supports several backends: RTT, UART, and <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/lib_cli.html" target="_blank">Command Line Interface</a> (CLI).</p>
<p>The CLI allows for bidirectional communication with Smart Remote. The device can send log messages and you can issue commands to control the device and dynamically change its behavior.</p>
<h1><a class="anchor" id="ble_console_setup"></a>
Setup</h1>
<p>To use the CLI on Smart Remote for nRF52810, you must compile the firmware with the <b>CLI over BLE</b> option enabled in the configuration header file. Due to memory size restrictions, the firmware will not compile with this option unless you disable some other features to provide enough free space in memory. See <a class="el" href="working_with_n_r_f52810.html">Working with Smart Remote 3 for nRF52810</a>. <br/>
 On Smart Remote nRF52832, this option is enabled by default and present in the precompiled firmware.</p>
<div class="image">
<img src="cli_over_ble.png" alt="cli_over_ble.png"/>
<div class="caption">
Enabling console over BLE in Keil IDE</div></div>
<p> Next, flash the firmware to Smart Remote. For instructions on how to flash the device, check <a class="el" href="firmware_upgrade.html">Firmware upgrade via cable connection</a>.</p>
<p>After flashing, <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.rds/dita/rds/designs/smart_remote/smart_remote_3_nrf52/quick_start/pair_w_ubuntu.html" target="_blank">pair the device</a> with the NVS Ubuntu host.</p>
<h1><a class="anchor" id="ble_console_usage"></a>
Usage</h1>
<p><em>Bluetooth</em> Console is preinstalled and ready to use on the NVS 5.4 LiveCD Ubuntu ISO. After launching NVS Ubuntu, you can start <em>Bluetooth</em> Console using a desktop shortcut or from the Linux terminal, using the <code>BluetoothConsole</code> command.</p>
<div class="image">
<img src="ubuntu_desktop_icons.png" alt="ubuntu_desktop_icons.png"/>
<div class="caption">
Desktop shortcuts to Bluetooth Console and Audio Probe</div></div>
<p> <em>Bluetooth</em> Console requires BlueZ running in experimental mode in order to access all BLE GATT characteristics. On NVS LiveCD Ubuntu, this is already set up. On other Linux systems, you must modify the file <code>/etc/systemd/system/bluetooth.service</code>. Find the line: </p>
<pre class="fragment">ExecStart=/usr/lib/bluetooth/bluetoothd
</pre><p>and add <code>-E</code> flag to start BlueZ in experimental mode by default. </p>
<pre class="fragment">ExecStart=/usr/lib/bluetooth/bluetoothd -E
</pre><p>Make sure the device is paired with the host. After launching <em>Bluetooth</em> Console, you can connect to a compatible device. Smart Remote devices that are paired with the host should be visible in the <b>Select device</b> menu.</p>
<div class="image">
<img src="ble_console_select_device.png" alt="ble_console_select_device.png"/>
<div class="caption">
Selecting a device in Bluetooth Console</div></div>
<p> When the CLI over BLE connection is established, a black terminal window appears. You can now enter commands.</p>
<div class="image">
<img src="ble_console_connected.png" alt="ble_console_connected.png"/>
<div class="caption">
Active CLI over BLE connection</div></div>
<p> If the delay during typing is significant, you can make the console more responsive by disabling slave latency on the <em>Bluetooth</em> connection. This can be done using the command <code>ble sl disable</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Disabled slave latency comes at a cost of increased power usage. <br/>
</dd>
<dd>
The changes made through the console (such as BLE slave latency, logger settings) are discarded when Smart Remote goes to sleep mode.</dd></dl>
<p>You can easily check what commands are currently available on the Smart Remote device by pressing <code>Tab</code>. Autocompletion of commands is also available with the <code>Tab</code> key. See <a class="el" href="logger.html">Logger and CLI</a>.</p>
<div class="image">
<img src="ble_console_slave_latency.png" alt="ble_console_slave_latency.png"/>
<div class="caption">
Disabling slave latency to make BLE console more responsive</div></div>
<p> When the Smart Remote goes to sleep, the <em>Bluetooth</em> connection becomes inactive. This is indicated to the user by striking through the device name and graying out the terminal. When the device wakes up, the terminal turns black again.</p>
<div class="image">
<img src="ble_console_inactive.png" alt="ble_console_inactive.png"/>
<div class="caption">
Grayed out terminal after device has disconnected</div></div>
<p> It is possible to control and communicate with multiple devices at the same time. If the user selects more paired devices, each one will have its own terminal in a separate tab.</p>
<div class="image">
<img src="ble_console_multi.png" alt="ble_console_multi.png"/>
<div class="caption">
Multiple Smart Remote devices used simultaneously.</div></div>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Jun 7 2018" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
