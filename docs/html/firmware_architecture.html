<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Smart Remote 3 nRF52 v1.2 : Firmware architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Smart Remote 3 nRF52 v1.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s130","s132","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('firmware_architecture.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Firmware architecture </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="firmware_architecture"></a> The Smart Remote firmware consists of independent modules grouped around the event bus, which functions as the main communication channel in the system. The modules broadcast messages using the event bus or react to messages that are sent by other modules.</p>
<div class="image">
<img src="sr3_nrf52_fw_arch.svg" alt="sr3_nrf52_fw_arch.svg"/>
<div class="caption">
Firmware architecture block diagram</div></div>
<p> The modules can be divided into three categories, based on their role in the system:</p>
<ul>
<li><a class="el" href="group__input.html">Input Modules</a> use dedicated drivers to fetch data from sensors or from the user. They generate events when new input is available.</li>
<li><a class="el" href="group__output.html">Output modules</a> work in the opposite way: they monitor the event bus and when a corresponding event is detected, they send data or change hardware state using dedicated drivers.</li>
<li><a class="el" href="group__system__protocol.html">System state and protocol modules</a> do not communicate with the hardware but take care of the firmware itself. This group consists of the system state module, which is responsible for the firmware state management as a whole, and the protocol modules, which decide what and when is sent over the output interfaces.</li>
</ul>
<p>For example, when a keyboard key is pressed, the keyboard module sends an EVT_KEY_DOWN event with a corresponding key identifier. When the HID protocol module detects this message, it checks if the given key is mapped to a HID usage code. If it is mapped, it sends an EVT_HID_REPORT_INPUT message with a corresponding usage code. This message is interpreted by the communication module which updates its state and sends the report to the host. At the same time, the IR protocol module checks the IR keyboard map in response to the EVT_KEY_DOWN message. If the key is mapped, it sends an EVT_IR_SYMBOL event, which is interpreted by the IR Transmission module, responsible for controlling the IR transmitter.</p>
<p>Because all event messages that are sent over the event bus have to use a common event_t data structure, all modules use the same unified data format. Also, to keep the design of individual modules simple and straightforward, all of them operate on the same interrupt level. This assures context unification and eliminates the need of explicit synchronization and locking. For details about context management, consult <a class="el" href="task_management_latency_minimization.html">Task management and latency minimization</a>.</p>
<p>In the Smart Remote firmware architecture, modules cannot directly communicate with the hardware. Instead, they use dedicated drivers. The drivers abstract the hardware of a particular type, providing simple API for basic operations, like power management, data readout, and similar. All data and state management is realized by the corresponding module that handles a given peripheral.</p>
<h1><a class="anchor" id="firmware_architecture_details"></a>
Firmware architecture aspects</h1>
<p>See the following sections for detailed descriptions of specific aspects of the firmware architecture.</p>
<p><a class="el" href="audio.html">Audio subsystem</a></p>
<p><a class="el" href="ble_advertisement.html">BLE advertisement</a></p>
<p><a class="el" href="ble_connection.html">BLE connection management</a></p>
<p><a class="el" href="ble_services.html">BLE services</a></p>
<p><a class="el" href="clocking_options.html">Clocking options</a></p>
<p><a class="el" href="firmware_components.html">Firmware components</a></p>
<p><a class="el" href="_h_i_d.html">HID report descriptor</a></p>
<p><a class="el" href="hid_subsystem.html">HID state subsystem</a></p>
<p><a class="el" href="ir.html">Infrared transmitter</a></p>
<p><a class="el" href="nfc.html">NFC pairing</a></p>
<p><a class="el" href="packet_scheduling.html">Packet scheduling</a></p>
<p><a class="el" href="api_calls_pattern.html">Pattern of the API calls</a></p>
<p><a class="el" href="power_management.html">Power management</a></p>
<p><a class="el" href="task_management_latency_minimization.html">Task management and latency minimization</a></p>
<p><a class="el" href="user_input.html">User input</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Jun 7 2018" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
