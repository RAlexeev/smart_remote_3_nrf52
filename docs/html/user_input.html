<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Smart Remote 3 nRF52 v1.2 : User input</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Smart Remote 3 nRF52 v1.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s130","s132","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('user_input.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">User input </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Smart Remote offers comprehensive user input options. It supports a classic keyboard, motion tracking, as well as a touchpad.</p>
<h1><a class="anchor" id="user_input_keypad"></a>
Keyboard</h1>
<p>Smart Remote offers two distinct keyboard drivers. Both support up to 64 keys arranged in a matrix with up to 8 rows and 8 columns, and both can be scaled down to any row/column count. One driver expects that the matrix is connected directly to the nRF52 GPIOs, while the other one uses SX1509 I/O expanders connected to a two-wire bus.</p>
<p>The GPIO-based driver is designed to minimize power consumption and it is recommended for the final design. The driver waits for an interrupt generated by pressing any key. The interrupt triggers a scanning procedure which is executed at regular intervals configured by the <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga5dba382d7b44096d1bc3d59ca54111b0">CONFIG_KBD_POLL_INTERVAL</a> option, as long as at least one key is pressed. The driver switches back to interrupt mode if no key press is detected in three consecutive scans.</p>
<p>If the remote uses the GPIO-based driver, the keyboard can be configured as a wakeup source (see <a class="el" href="power_management.html">Power management</a>). Such behavior is enabled by the <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gaa7e9e476b9767246558e377f5345c700">CONFIG_KBD_WAKEUP_SOURCE</a> option.</p>
<p>The SX1509-based driver is recommended for prototypes, where GPIO pins are used for testing and/or debugging purposes. It works in the similar way as the GPIO-based driver. However, as the keyboard is scanned continuously, power consumption is increased.</p>
<p>Regardless of the driver used, Smart Remote offers several features simplifying key processing in the firmware. These include:</p>
<ul>
<li>Key press timestamps.</li>
<li>Dedicated events generated if a key is held over a predefined time.</li>
<li>Key combinations detection (hold key A, B, and C for T seconds to trigger an action).</li>
</ul>
<p>Despite the fact that the Smart Remote core is able to handle 65536 different key codes, the maximum number of keys in the system is limited by the following restrictions:</p>
<ul>
<li>Although the keyboard drivers support up to 64 keys, only <a class="el" href="group___d_r_v___k_e_y_b_o_a_r_d.html#gaeb827448fd306de6ff4c32fdcdf2161f">DRV_KEYBOARD_MAX_KEYS</a> can be pressed simultaneously.</li>
<li>In order to save memory, the keyboard module uses 8-bit key identifiers reducing the number of keys to 256.</li>
<li>The HID descriptor used by Smart Remote puts an additional restriction on the number of simultaneous key presses sent by the remote (for more information, refer to <a class="el" href="_h_i_d.html">HID report descriptor</a>.)</li>
</ul>
<h1><a class="anchor" id="user_input_gyro"></a>
Motion</h1>
<p>Smart Remote is able to convert device orientation into X/Y mouse cursor movement sent to the host, providing Air Mouse functionality. This function is performed by a dedicated library, which converts data from a 6-axis motion tracking chip (integrating both an accelerometer and a gyroscope) into motion on an imaginary X/Y plane located ahead of the remote.</p>
<p>When activated by the <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gad3f8998617073bbb29f66daf2e1bd191">CONFIG_GYRO_MODE_KEY_ID</a> key, the gyroscope driver starts polling the motion tracking chip every <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gae094be2196b133d09d72375b38c631f8">CONFIG_GYRO_POLL_INTERVAL</a> milliseconds.</p>
<dl class="section note"><dt>Note</dt><dd>The polling interval may be configured, however the motion processing library expects a 10 ms polling rate.</dd></dl>
<p>The linear and angular accelerations are then passed to the library which converts these values into delta movements on the X/Y plane. Gain of the process can be adjusted using the <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga01089f5bb5db6966900b223bed66ae91">CONFIG_GYRO_X_GAIN</a> and <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga68563327b157aec78ea49afe3e59e6ff">CONFIG_GYRO_Y_GAIN</a> options. The gyroscope mode is deactivated when <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gad3f8998617073bbb29f66daf2e1bd191">CONFIG_GYRO_MODE_KEY_ID</a> is pressed again or when there is no movement for <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga87998e11423ee0a1dcd999542c135d9d">CONFIG_GRYO_IDLE_TIMEOUT</a> seconds.</p>
<h2><a class="anchor" id="gyro_calibration"></a>
Gyroscope calibration</h2>
<p>The gyroscope is automatically calibrated on the first firmware boot. Calibration can be also performed on user request by holding <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gad3f8998617073bbb29f66daf2e1bd191">CONFIG_GYRO_MODE_KEY_ID</a> for 3 seconds (this functionality is available only when key combinations detection is enabled by setting <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gab3ac3de57be9e0c1e4c44aa8dc44fb68">CONFIG_KBD_KEY_COMBO_ENABLED</a> to 1). In both cases, calibration data is saved to flash. Moreover, the motion processing library performs automatic sensor calibration when the device remains stationary for at least one second. This is done to eliminate aging effects.</p>
<dl class="section note"><dt>Note</dt><dd>Smart Remote has another accelerometer used solely for waking up the device. When enabled (by setting both <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gad9891c4a37db3be8dee822d2518eac78">CONFIG_ACC_ENABLED</a> and <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga39143fb36982e6354a69eb81e3bbb1e7">CONFIG_ACC_WAKEUP_SOURCE</a> options to 1), it wakes up the device on the slightest movement in order to mitigate key press transmission delay introduced by device boot and by the <em>Bluetooth</em> connection setup. See <a class="el" href="power_management.html">Power management</a>.</dd></dl>
<h1><a class="anchor" id="user_input_touchpad"></a>
Touchpad</h1>
<p>Smart Remote supports a classic touchpad. Both X/Y motion, basic gestures (wheel/pan), as well as clicks are recognized and forwarded to the host as HID reports. The remote polls the touchpad every <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gac8c1747ac91e16b7362f68f33fc39863">CONFIG_TOUCHPAD_POLL_INTERVAL</a> milliseconds and generates appropriate events based on the reported status. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Jun 7 2018" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
