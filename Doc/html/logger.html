<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Smart Remote 3 nRF52 v1.2 : Logger and CLI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Smart Remote 3 nRF52 v1.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s130","s132","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('logger.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Logger and CLI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Smart Remote features an extended debugging infrastructure that is based on the nRF5 SDK v14.2.0 <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/nrf_log.html" target="_blank">Logger</a> and <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/lib_cli.html" target="_blank">Command Line Interface</a> modules.</p>
<p>The logger is the main communication channel between the developer integrating the system and the firmware.</p>
<p>You can use three backends to work with the logger and CLI.</p>
<ul>
<li>Real Time Terminal (RTT)</li>
<li>UART</li>
<li><em>Bluetooth</em> Low Energy (BLE)</li>
</ul>
<p>The RTT logger with CLI is by default <b>enabled</b> in <b>nRF52832</b> projects.</p>
<p>In <b>nRF52810</b> projects, the logger is by default <b>disabled</b>. See <a class="el" href="working_with_n_r_f52810.html">Working with Smart Remote 3 for nRF52810</a> for instructions on how to enable it.</p>
<h1><a class="anchor" id="logger_setup"></a>
Setting up logger and CLI over RTT</h1>
<p>RTT communication is established in two steps:</p>
<ul>
<li>J-Link Commander is used to start an RTT connection,</li>
<li>a telnet client is used for communication over the RTT channel.</li>
</ul>
<p>To set up communication over RTT, download and install <a href="https://www.segger.com/downloads/jlink" target="_blank">J-Link</a>.</p>
<h2><a class="anchor" id="logger_windows"></a>
Using RTT on Windows</h2>
<p>To communicate over RTT, you need a telnet client. On Windows, <a href="https://www.putty.org/" target="_blank">PuTTY</a> is recommended.</p>
<dl class="section note"><dt>Note</dt><dd>Using RTT Viewer may result in incorrect display of data from the logger and CLI.</dd></dl>
<p>Make sure "jlink.exe" is in your PATH system variable. To start J-Link and automatically connect to Smart Remote, run </p>
<div class="fragment"><div class="line">jlink.exe -autoconnect 1 -device NRF52832_XXAA -<span class="keywordflow">if</span> SWD -speed 4000</div>
</div><!-- fragment --><p>You will see the J-Link Commander starting and connecting to the device. </p>
<div class="fragment"><div class="line">SEGGER J-Link Commander V6.14d (Compiled Apr 19 2017 18:26:24)</div>
<div class="line">DLL version V6.14d, compiled Apr 19 2017 18:25:54</div>
<div class="line"></div>
<div class="line">Connecting to J-Link via USB...O.K.</div>
<div class="line">Firmware: J-Link OB-SAM3U128-V2-NordicSemi compiled Jan 12 2018 16:05:20</div>
<div class="line">Hardware version: V1.00</div>
<div class="line">S/N:</div>
<div class="line">VTref = 3.300V</div>
<div class="line">Device <span class="stringliteral">&quot;NRF52832_XXAA&quot;</span> selected.</div>
<div class="line"></div>
<div class="line">Found SW-DP with ID 0x2BA01477</div>
<div class="line">Found SW-DP with ID 0x2BA01477</div>
<div class="line">AP-IDR: 0x24770011, Type: AHB-AP</div>
<div class="line">AHB-AP ROM: 0xE00FF000 (Base addr. of first ROM table)</div>
<div class="line">Found Cortex-M4 r0p1, Little endian.</div>
<div class="line">FPUnit: 6 code (BP) slots and 2 literal slots</div>
<div class="line">CoreSight components:</div>
<div class="line">ROMTbl[0] @ E00FF000</div>
<div class="line">ROMTbl[0][0]: E000E000, CID: B105E00D, PID: 000BB00C SCS</div>
<div class="line">ROMTbl[0][1]: E0001000, CID: B105E00D, PID: 003BB002 DWT</div>
<div class="line">ROMTbl[0][2]: E0002000, CID: B105E00D, PID: 002BB003 FPB</div>
<div class="line">ROMTbl[0][3]: E0000000, CID: B105E00D, PID: 003BB001 ITM</div>
<div class="line">ROMTbl[0][4]: E0040000, CID: B105900D, PID: 000BB9A1 TPIU</div>
<div class="line">ROMTbl[0][5]: E0041000, CID: B105900D, PID: 000BB925 ETM</div>
<div class="line">Cortex-M4 identified.</div>
<div class="line">J-Link&gt;</div>
</div><!-- fragment --><p>When connecting to the device, J-Link starts a telnet server which can be used for bidirectional communication. To connect, run a PuTTY session with the <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/lib_cli.html#lib_cli_terminal_settings" target="_blank">settings described here</a>. Logging data from Smart Remote appears with the possibility to issue CLI commands.</p>
<div class="image">
<img src="logger_rtt_windows.png" alt="logger_rtt_windows.png"/>
<div class="caption">
Using PuTTY to communicate with Smart Remote</div></div>
<p>If you do not see logs from Smart Remote, restart the device from J-Link console with <code>r</code> (reset) and <code>g</code> (go). </p>
<pre class="fragment">J-Link&gt;r
J-Link&gt;g
</pre><p>The device only starts logging on RTT if the debugger is connected on startup.</p>
<h2><a class="anchor" id="logger_linux"></a>
Using RTT on Linux</h2>
<p>To communicate over RTT on Linux, install <a href="https://www.segger.com/downloads/jlink" target="_blank">J-Link software</a>. Make sure JLinkExe and JLinkRTTClient are in your system path. Then, run: </p>
<pre class="fragment">JLinkExe -autoconnect 1 -device NRF52832_XXAA -if SWD -speed 4000
</pre><p>In a separate terminal, start the RTT client. </p>
<pre class="fragment">JLinkRTTClient
</pre><p>If you do not receive logs from Smart Remote, go to the JLinkExe terminal and reset the device using <code>r</code> (reset) and <code>g</code> (go).</p>
<p>RTT logger and CLI also work with the terminal in <a class="el" href="audioprobe.html">Audio Probe</a>.</p>
<h1><a class="anchor" id="logger_uart"></a>
Communication over UART</h1>
<p>To enable communication over UART, compile the firmware with the option <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga682c01c1d34e75fee121475bddf6e76e">CONFIG_CL_UART_ENABLED</a>. You can set UART pins with <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gad8470b58855d3d08e8ac1c0733eb061c">CONFIG_UART_TX_PIN</a> and <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga6c4a76bb95e1f53777e818c24edd02fb">CONFIG_UART_RX_PIN</a>. For the Shield target, the UART pins are preconfigured. The UART baud rate can be set with <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga38467b32a830d962f6e4444aea8a75bc">CONFIG_CL_UART_BAUDRATE</a>. Parity can be set with <a class="el" href="group__sr3__config__nrf52832__pca63519.html#ga53d7de44b46d1022c9cca0b1e799cac3">CONFIG_CL_UART_PARITY</a>. Hardware flow control can be enabled with <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gab52a6c2364b124df84dd2aa63c46eebf">CONFIG_CL_UART_HWFC</a>.</p>
<div class="image">
<img src="logger_uart.png" alt="logger_uart.png"/>
</div>
<h1><a class="anchor" id="logger_ble"></a>
Communication over BLE</h1>
<p>You can communicate with Smart Remote over a wireless <em>Bluetooth</em> Low Energy link.</p>
<p><a class="el" href="ble_console.html">Bluetooth Console</a> is provided in NVS 5.4 Ubuntu LiveCD to give access to logger and CLI over BLE.</p>
<h1><a class="anchor" id="logger_commands"></a>
Logger configuration</h1>
<p>In Smart Remote, each event is logged with a timestamp (value in the brackets), which is the time since the firmware start expressed in RTC ticks (one RTC tick = 1/32768 s). When the logger "deferred" mode is used (this is the default setting), logging does not impact time-sensitive tasks. Instead, they are saved in a queue and processed in idle state. See <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/nrf_log.html" target="_blank">logger documentation</a> for details of log processing.</p>
<p>It is possible to log events on different levels of severity. Five levels are available – Debug, Info, Warning, Error, and None. The logging system is highly configurable:</p>
<ul>
<li>The number of debugging events generated by each module is controlled by <em>Module logging level</em> available under <em>Logging Options</em> for each Smart Remote feature.</li>
<li>Logging level limit is set separately for RTT, UART, and BLE transports.</li>
<li>Logging level can be limited globally for the whole firmware at compile time with <a class="el" href="group__sr3__config__nrf52832__pca63519.html#gabdf5dc1478dc564128e380f92368e8b5">CONFIG_LOG_LEVEL_CAP</a>.</li>
</ul>
<p>The final number of log messages (compiled-in limit) depends on the strictest of the above log level settings. When CLI console is used, the log level limitation of the backend is not taken into account. With CLI, the backend logging level is just an initial setting which can be changed.</p>
<ul>
<li>Example 1: user sets <b>NFC logging level</b> to Debug and the <b>global logging level cap</b> to Warning. <br/>
 Only messages of level Warning or higher (Warning and Error) are printed out.</li>
</ul>
<ul>
<li>Example 2: user sets <b>NFC logging level</b> to Debug, <b>global logging level cap</b> to Debug, <b>RTT logging level</b> to Info, and <b>UART logging level</b> to Warning.<br/>
 On RTT, only messages of level Info or higher (Info, Warning, and Error) are printed out.<br/>
 On UART, only messages of level Warning or higher are printed out.</li>
</ul>
<div class="image">
<img src="logger_options.png" alt="logger_options.png"/>
<div class="caption">
Logger and CLI configuration in Smart Remote</div></div>
<p>On each backend (transport), it is possible to use only the logger (one-way communication) or the logger with the console (two-way communication). An exception is the BLE backend, where using the logger without the console is not possible.</p>
<p>The console can be also used without the logger. To enable the console without the logger on a specific backend, choose the CLI interface and disable the option <em>Use CLI as logger backend</em>. </p>
<div class="image">
<img src="logger_cli_plain.png" alt="logger_cli_plain.png"/>
<div class="caption">
Choosing CLI without the logger</div></div>
<p>When the CLI is used, the number of logged events can be dynamically filtered at runtime for each module and each backend independently using the <code>log</code> command. The same module can have different logging settings on different backends.</p>
<p>To see the current runtime logging levels, use the <code>log status</code> command. </p>
<dl class="section note"><dt>Note</dt><dd>Setting logging level at runtime is possible up to the compiled-in limit, which is specified by the global cap, transport logging level, and compiled-in module logging level.</dd></dl>
<ul>
<li>Example 3: user sets <b>NFC logging level</b> to Info, <b>global logging level cap</b> to Debug, and <b>BLE logging level</b> to Warning. <br/>
 By default, the messages of level Warning or higher are printed out.<br/>
 With CLI commands, it is possible to set dynamic logging level at runtime up to the global cap, in this case to Debug, Info, Warning, or Error.<br/>
 When connected to CLI over BLE, the user can issue a command like <code>log enable debug m_nfc</code> to set runtime NFC logging level to Debug.</li>
</ul>
<div class="image">
<img src="logger_log_enable.png" alt="logger_log_enable.png"/>
<div class="caption">
Changing logging level of a module at runtime using CLI command</div></div>
<h1><a class="anchor" id="logger_cli_commands"></a>
CLI commands in Smart Remote</h1>
<p>Smart Remote comes with some built-in commands which help the user inspect and control the system. Users can <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.sdk5.v14.2.0/lib_cli.html#lib_cli_commands_sub_creation" target="_blank">register their own commands</a>.</p>
<p>For a list of commands available, press <code>Tab</code>. To receive information about each command, use the <code>--help</code> switch. Autocompletion is also available for each command and subcommand.</p>
<div class="image">
<img src="logger_cli_commands.png" alt="logger_cli_commands.png"/>
<div class="caption">
Getting help on CLI commands</div></div>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Jun 7 2018" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
